================================================
  NLOC    CCN   token  PARAM  length  location  
------------------------------------------------
       6      3     22      0       6 iter_cases@25-30@./scripts/generate_template_docs.py
      28      3    142      2      28 render_case_markdown@33-60@./scripts/generate_template_docs.py
       4      2     24      1       4 _format_json.default@66-69@./scripts/generate_template_docs.py
       4      1     35      1       9 _format_json@63-71@./scripts/generate_template_docs.py
       8      5     69      1       8 _normalise_for_json@74-81@./scripts/generate_template_docs.py
      11      2     92      0      13 main@84-96@./scripts/generate_template_docs.py
       2      1     15      0       2 _utc_now@23-24@./webbed_duck/server/cache.py
       6      4     32      1       6 _decode_null@27-32@./webbed_duck/server/cache.py
       2      2     41      1       2 _freeze_str_mapping@35-36@./webbed_duck/server/cache.py
       4      2     62      1       4 _freeze_token_mapping@39-42@./webbed_duck/server/cache.py
       7      2     37      3       7 _handle_expiry@45-51@./webbed_duck/server/cache.py
       6      3     53      1       6 _stringify@54-59@./webbed_duck/server/cache.py
      10      4     70      1      10 _normalize_items@62-71@./webbed_duck/server/cache.py
       6      3     44      1       6 _ensure_sequence@74-79@./webbed_duck/server/cache.py
      12      3     82      4      12 _encode_constant_value@82-93@./webbed_duck/server/cache.py
      11      1     83      3      11 _compute_digest@96-106@./webbed_duck/server/cache.py
      10      5     72      1      10 _ensure_arrow_table@109-118@./webbed_duck/server/cache.py
       2      2     23      1       2 __post_init__@130-131@./webbed_duck/server/cache.py
      14      5     95      2      14 normalize@133-146@./webbed_duck/server/cache.py
       9      4     49      2       9 _normalize_candidate@148-156@./webbed_duck/server/cache.py
       4      2     31      2       4 encode@158-161@./webbed_duck/server/cache.py
       7      3     65      3       7 apply@163-169@./webbed_duck/server/cache.py
      16      6    109      3      16 _predicate_for@171-186@./webbed_duck/server/cache.py
      11      5    107      3      11 _membership_predicate@188-198@./webbed_duck/server/cache.py
      12      3     79      4      12 _include_nulls@200-211@./webbed_duck/server/cache.py
       9      3     70      1       9 __post_init__@223-231@./webbed_duck/server/cache.py
      30      7    218      5      30 from_parts@252-281@./webbed_duck/server/cache.py
       2      1     16      1       2 parameter_values@284-285@./webbed_duck/server/cache.py
       2      1     16      1       2 constant_values@288-289@./webbed_duck/server/cache.py
       2      1     21      1       2 invariant_tokens@292-293@./webbed_duck/server/cache.py
       3      1     37      1       3 __post_init__@322-324@./webbed_duck/server/cache.py
       2      1     23      1       2 to_pylist@326-327@./webbed_duck/server/cache.py
       2      1     20      2       2 __getattr__@329-330@./webbed_duck/server/cache.py
       3      1     30      2       3 __init__@336-338@./webbed_duck/server/cache.py
       2      1     19      2       2 _entry_dir@340-341@./webbed_duck/server/cache.py
      19      3    142      3      19 load_entry@343-361@./webbed_duck/server/cache.py
      47      6    300      7      47 write_entry@363-409@./webbed_duck/server/cache.py
       8      4     72      2       8 read_entry@411-418@./webbed_duck/server/cache.py
       4      2     32      2       4 evict@420-423@./webbed_duck/server/cache.py
      11      3     57      3      11 scan_entries@425-435@./webbed_duck/server/cache.py
      31      7    281      4      31 _entry_from_metadata@437-467@./webbed_duck/server/cache.py
      13      3    100      6      13 __init__@473-485@./webbed_duck/server/cache.py
      45      3    260      2      47 fetch_or_populate@487-533@./webbed_duck/server/cache.py
       3      1     38      3       3 _apply_filters@535-537@./webbed_duck/server/cache.py
       8      3     63      3       8 _apply_invariant_filters@539-546@./webbed_duck/server/cache.py
      10      3     56      3      10 _apply_constant_filters@548-557@./webbed_duck/server/cache.py
      10      3     76      3      10 _filter_by_column@559-568@./webbed_duck/server/cache.py
      10      3     83      3      10 _constant_predicate@570-579@./webbed_duck/server/cache.py
      20      1     89      6      20 _build_result@581-600@./webbed_duck/server/cache.py
      24      5    111      3      24 _find_superset_entry@602-625@./webbed_duck/server/cache.py
      11      5     85      3      11 _non_invariant_equal@627-637@./webbed_duck/server/cache.py
      21      7    147      6      21 _entry_is_superset@639-659@./webbed_duck/server/cache.py
       2      2     44      2       4 merge_formats@62-65@./webbed_duck/_templating/formatters.py
       7      3     65      3       9 date_offset@68-76@./webbed_duck/_templating/formatters.py
       4      2     30      1       4 _ensure_datetime@79-82@./webbed_duck/_templating/formatters.py
      11      6    108      3      17 format_date@85-101@./webbed_duck/_templating/formatters.py
      15      6    129      3      22 format_timestamp@104-125@./webbed_duck/_templating/formatters.py
      17      6    110      3      23 format_number@128-150@./webbed_duck/_templating/formatters.py
      13      2     85      1      16 stringify@153-168@./webbed_duck/_templating/formatters.py
      13      1    106      2      13 __init__@27-39@./webbed_duck/_templating/renderer.py
       4      1     35      1       4 render.replace@42-45@./webbed_duck/_templating/renderer.py
       3      1     24      2       7 render@41-47@./webbed_duck/_templating/renderer.py
      10      6     80      2      11 _evaluate_expression@49-59@./webbed_duck/_templating/renderer.py
       8      2     47      2       8 _resolve_path@61-68@./webbed_duck/_templating/renderer.py
      19      7    147      2      19 _eval_ast@70-88@./webbed_duck/_templating/renderer.py
      10      4     60      3      10 _resolve_getattr@90-99@./webbed_duck/_templating/renderer.py
       8      3     44      3       8 _resolve_getitem@101-108@./webbed_duck/_templating/renderer.py
      14      7    147      3      15 _apply_modifier@110-124@./webbed_duck/_templating/renderer.py
       5      3     51      4       5 _handle_coalesce@126-130@./webbed_duck/_templating/renderer.py
       4      1     35      4       4 _handle_date_offset@132-135@./webbed_duck/_templating/renderer.py
       5      2     57      4       5 _handle_date_format@137-141@./webbed_duck/_templating/renderer.py
       5      2     57      4       5 _handle_timestamp_format@143-147@./webbed_duck/_templating/renderer.py
       5      2     57      4       5 _handle_number_format@149-153@./webbed_duck/_templating/renderer.py
       5      2     34      2       5 _literal_eval@155-159@./webbed_duck/_templating/renderer.py
       7      1     47      1       7 __post_init__@23-29@./webbed_duck/_templating/parameters.py
       8      2     49      1      10 resolve@31-40@./webbed_duck/_templating/parameters.py
       6      1     43      2       8 StringParameterWhitelist@43-50@./webbed_duck/_templating/parameters.py
       7      3     51      2       7 _freeze_iterable@53-59@./webbed_duck/_templating/parameters.py
      26      4    162      3      28 from_manifest@48-75@./webbed_duck/_templating/binding.py
      13      4    115      2      15 from_manifest@86-100@./webbed_duck/_templating/binding.py
       2      1     25      2       2 resolve@102-103@./webbed_duck/_templating/binding.py
      12      2     98      3      12 __init__@121-132@./webbed_duck/_templating/binding.py
       2      1     18      2       2 __getitem__@134-135@./webbed_duck/_templating/binding.py
       2      1     17      1       2 __iter__@137-138@./webbed_duck/_templating/binding.py
       2      1     14      1       2 __len__@140-141@./webbed_duck/_templating/binding.py
       2      1     17      1       4 configuration@144-147@./webbed_duck/_templating/binding.py
       6      2     41      2       8 attach_configuration@149-156@./webbed_duck/_templating/binding.py
       3      1     25      2       5 with_configuration@158-162@./webbed_duck/_templating/binding.py
      57      9    295      3      65 from_manifest@165-229@./webbed_duck/_templating/binding.py
       4      1     31      2       4 for_template.__getitem__@244-247@./webbed_duck/_templating/binding.py
       4      2     29      3       4 for_template.get@249-252@./webbed_duck/_templating/binding.py
       2      1     20      2       2 for_template.__contains__@254-255@./webbed_duck/_templating/binding.py
      15      4     89      1      28 for_template@231-258@./webbed_duck/_templating/binding.py
       9      7     78      2       9 for_binding@260-268@./webbed_duck/_templating/binding.py
       2      1     17      1       2 template_consumed@271-272@./webbed_duck/_templating/binding.py
      16      5    113      3      16 _collect_unknown_parameters@275-290@./webbed_duck/_templating/binding.py
      22      7    109      3      24 _coerce_value@293-316@./webbed_duck/_templating/binding.py
      14      5     96      1      14 _coerce_boolean@319-332@./webbed_duck/_templating/binding.py
      22      4     81      4      23 _run_guards@335-357@./webbed_duck/_templating/binding.py
      15      5     91      4      15 _validate_choices_guard@360-374@./webbed_duck/_templating/binding.py
      16      5     99      4      16 _validate_regex_guard@377-392@./webbed_duck/_templating/binding.py
       9      3     75      3       9 _guard_mapping@395-403@./webbed_duck/_templating/binding.py
      20      4    142      4      20 _coerce_guard_values@417-436@./webbed_duck/_templating/binding.py
      21      7    123      4      24 _validate_length_guard@439-462@./webbed_duck/_templating/binding.py
      30     11    208      4      34 _validate_range_guard@465-498@./webbed_duck/_templating/binding.py
      16      5    101      4      19 _validate_path_guard@501-519@./webbed_duck/_templating/binding.py
      18      4    113      2      19 _resolve_path_guard_options@522-540@./webbed_duck/_templating/binding.py
       9      3     54      2       9 _coerce_path_guard_value@543-551@./webbed_duck/_templating/binding.py
      25     10    155      3      29 _collect_path_guard_errors@554-582@./webbed_duck/_templating/binding.py
      20      7     97      4      20 _validate_datetime_window_guard._check_boundary@610-629@./webbed_duck/_templating/binding.py
      31      8    156      4      54 _validate_datetime_window_guard@585-638@./webbed_duck/_templating/binding.py
      41     11    207      4      48 _validate_compare_guard@641-688@./webbed_duck/_templating/binding.py
       7      3     37      1       7 _as_float@691-697@./webbed_duck/_templating/binding.py
       7      3     37      1       7 _as_int@700-706@./webbed_duck/_templating/binding.py
      22      7    115      4      22 _parse_datetime_for_guard@709-730@./webbed_duck/_templating/binding.py
       4      2     30      1       4 _format_datetime_boundary@733-736@./webbed_duck/_templating/binding.py
       6      3     48      2       6 _datetimes_mixed_timezone_awareness@739-744@./webbed_duck/_templating/binding.py
       3      1     23      3       3 __init__@750-752@./webbed_duck/_templating/binding.py
       2      1     24      3       2 compare@754-755@./webbed_duck/_templating/binding.py
       6      2     30      3       6 message@757-762@./webbed_duck/_templating/binding.py
       9      2     65      3       9 __init__@31-39@./webbed_duck/_templating/state.py
       5      2     25      2       5 _ensure_allowed@41-45@./webbed_duck/_templating/state.py
       3      1     26      2       3 __getitem__@47-49@./webbed_duck/_templating/state.py
       2      2     36      3       2 get@51-52@./webbed_duck/_templating/state.py
      16      1     92      1      16 __init__@71-86@./webbed_duck/_templating/state.py
       2      1     16      1       2 get@88-89@./webbed_duck/_templating/state.py
       2      1     24      2       2 set@91-92@./webbed_duck/_templating/state.py
       4      2     29      1       4 ensure_mapping@95-98@./webbed_duck/_templating/state.py
      39      4    292      1      45 prepare_context@101-145@./webbed_duck/_templating/state.py
      10      5     67      1      10 _resolve_string_whitelist@148-157@./webbed_duck/_templating/state.py
       2      1     21      1       4 set_request_context@14-17@./webbed_duck/constants.py
       6      2     52      2      18 apply_constants@20-37@./webbed_duck/constants.py
       2      1     18      2       2 __init__@21-22@./tests/server/test_cache.py
       2      1     13      1       2 now@24-25@./tests/server/test_cache.py
       2      1     27      2       2 advance@27-28@./tests/server/test_cache.py
       7      3     42      1       7 _format_literal@31-37@./tests/server/test_cache.py
      12      3     98      2      12 _build_duckdb_table@40-51@./tests/server/test_cache.py
       2      1     17      1       2 tmp_cache_dir@55-56@./tests/server/test_cache.py
      20      1    131      1      21 test_cache_key_deterministic_and_null_sentinel@59-79@./tests/server/test_cache.py
       3      1     37      3       3 test_fetch_or_populate_persists_pages_and_enforces_ttl.runner@99-101@./tests/server/test_cache.py
      52      1    457      1      63 test_fetch_or_populate_persists_pages_and_enforces_ttl@82-144@./tests/server/test_cache.py
       3      1     37      3       3 test_invariant_filters_and_null_semantics.runner@170-172@./tests/server/test_cache.py
      50      4    389      1      59 test_invariant_filters_and_null_semantics@147-205@./tests/server/test_cache.py
       3      1     37      3       3 test_multi_value_invariant_superset_reuse_and_metadata.runner@233-235@./tests/server/test_cache.py
      92      4    707      1     106 test_multi_value_invariant_superset_reuse_and_metadata@208-313@./tests/server/test_cache.py
       3      1     37      3       3 test_case_insensitive_invariant_tokens.runner@336-338@./tests/server/test_cache.py
      51      2    398      1      62 test_case_insensitive_invariant_tokens@316-377@./tests/server/test_cache.py
       3      1     37      3       3 test_numeric_invariant_tokens_apply_column_type.runner@399-401@./tests/server/test_cache.py
      33      1    259      1      41 test_numeric_invariant_tokens_apply_column_type@380-420@./tests/server/test_cache.py
       2      1     21      1       2 build_validation@17-18@./tests/params/test_binding.py
      36      1    203      1      44 test_parameter_binding_coercion_and_defaults@21-64@./tests/params/test_binding.py
      21      1    100      0      25 test_parameter_binding_tracks_template_usage_via_renderer@67-91@./tests/params/test_binding.py
      11      1     54      0      13 test_missing_required_parameter@94-106@./tests/params/test_binding.py
      29      1    130      0      31 test_guard_failures@109-139@./tests/params/test_binding.py
      16      1    100      0      19 test_numeric_range_guard@142-160@./tests/params/test_binding.py
      24      1    121      0      29 test_datetime_window_guard@163-191@./tests/params/test_binding.py
      18      1     67      0      20 test_datetime_window_guard_timezone_mismatch@194-213@./tests/params/test_binding.py
      25      1    115      0      28 test_cross_field_compare_guard@216-243@./tests/params/test_binding.py
      20      1     87      0      23 test_template_whitelist_blocks_unapproved_parameters@244-266@./tests/params/test_binding.py
      25      1     97      0      28 test_binding_projection_filters_unused_parameters@269-296@./tests/params/test_binding.py
      13      1     54      0      15 test_unknown_parameters_rejected_by_default@299-313@./tests/params/test_binding.py
      21      1    113      0      26 test_binding_respects_unknown_parameter_policy@316-341@./tests/params/test_binding.py
      24      1    103      0      27 test_parameter_context_preserves_whitelist_for_constants@344-370@./tests/params/test_binding.py
       2      1      8      0       2 request_context@25-26@./tests/test_constants_apply.py
       2      1     22      2       2 test_apply_constants_across_supported_types@30-31@./tests/test_constants_apply.py
       3      1     19      1       3 test_date_offset_and_format@34-36@./tests/test_constants_apply.py
       3      1     19      1       3 test_extra_context_entries_are_ignored@39-41@./tests/test_constants_apply.py
       8      1     42      1       8 test_unapproved_string_is_blocked@44-51@./tests/test_constants_apply.py
      12      1     72      1      12 test_whitelist_rejects_disallowed_entries@54-65@./tests/test_constants_apply.py
       4      1     24      1       4 test_invalid_modifier_reports_error@68-71@./tests/test_constants_apply.py
       4      1     24      1       4 test_invalid_path_reports_error@74-77@./tests/test_constants_apply.py
       3      1     23      1       3 test_sql_template_round_trip@80-82@./tests/test_constants_apply.py
       3      1     25      2       3 test_unknown_format_keys_raise@90-92@./tests/test_constants_apply.py
       3      1     28      3       3 test_all_known_date_formats@99-101@./tests/test_constants_apply.py
       3      1     28      3       3 test_all_known_timestamp_formats@108-110@./tests/test_constants_apply.py
       4      2     37      3       4 test_common_number_formats@117-120@./tests/test_constants_apply.py
      12      1     46      0      12 validation_context@9-20@./tests/test_feature_safe_path_guard.py
       4      1     33      1       4 test_safe_path_guard_allows_relative_child@23-26@./tests/test_feature_safe_path_guard.py
       3      1     32      1       3 test_safe_path_guard_blocks_parent_segments@29-31@./tests/test_feature_safe_path_guard.py
       3      1     32      1       3 test_safe_path_guard_blocks_absolute_paths@34-36@./tests/test_feature_safe_path_guard.py
       3      1     32      1       3 test_safe_path_guard_blocks_backslashes@39-41@./tests/test_feature_safe_path_guard.py
      12      1     63      0      12 test_safe_path_guard_can_allow_parent_segments@44-55@./tests/test_feature_safe_path_guard.py
      13      1     60      1      13 test_safe_path_guard_respects_optional_parameter@58-70@./tests/test_feature_safe_path_guard.py
      15      2     77      1      15 test_safe_path_guard_configuration_validation@81-95@./tests/test_feature_safe_path_guard.py
       6      4     55      1       6 iter_python_files@35-40@./tools/complexity_report.py
      15      7    155      1      15 _normalized_shape@43-57@./tools/complexity_report.py
      94     20    716      1     102 collect_metrics@60-161@./tools/complexity_report.py
      14      4    126      2      15 write_radon_outputs@164-178@./tools/complexity_report.py
      10      2    137      2      10 _file_changed@181-190@./tools/complexity_report.py
       2      1     46      2       2 _function_key@193-194@./tools/complexity_report.py
      63     19    470      2      71 compare_metrics@197-267@./tools/complexity_report.py
       2      2     37      1       2 format_summary.fmt@271-272@./tools/complexity_report.py
      42      2    130      1      47 format_summary@270-316@./tools/complexity_report.py
       7      1     86      1       7 command_collect@319-325@./tools/complexity_report.py
       8      1    110      1       8 command_compare@328-335@./tools/complexity_report.py
      15      1    144      0      18 build_parser@338-355@./tools/complexity_report.py
       4      1     35      1       4 main@358-361@./tools/complexity_report.py
       2      1     19      0       4 build_report_request_context@124-127@./examples/request_constants.py
       2      1     16      2       2 _format_slug@202-203@./examples/request_constants.py
      42      8    187      0      45 _build_builtin_cases@209-253@./examples/request_constants.py
20 file analyzed.
==============================================================
NLOC    Avg.NLOC  AvgCCN  Avg.token  function_cnt    file
--------------------------------------------------------------
     77      10.2     2.7       64.0         6     ./scripts/generate_template_docs.py
    565      10.9     3.0       78.5        46     ./webbed_duck/server/cache.py
      2       0.0     0.0        0.0         0     ./webbed_duck/server/__init__.py
    118       9.9     3.9       81.6         7     ./webbed_duck/_templating/formatters.py
    133       7.9     2.9       65.4        15     ./webbed_duck/_templating/renderer.py
     20       0.0     0.0        0.0         0     ./webbed_duck/_templating/__init__.py
     39       7.0     1.8       47.5         4     ./webbed_duck/_templating/parameters.py
    626      13.5     4.0       82.3        42     ./webbed_duck/_templating/binding.py
    122       9.2     2.1       67.2        10     ./webbed_duck/_templating/state.py
      2       0.0     0.0        0.0         0     ./webbed_duck/_templating/errors.py
      2       0.0     0.0        0.0         0     ./webbed_duck/__init__.py
     13       4.0     1.5       36.5         2     ./webbed_duck/constants.py
    346      20.0     1.6      161.2        17     ./tests/server/test_cache.py
    295      20.4     1.0       97.5        14     ./tests/params/test_binding.py
     88       4.2     1.1       28.5        13     ./tests/test_constants_apply.py
      6       0.0     0.0        0.0         0     ./tests/conftest.py
     77       8.1     1.1       46.9         8     ./tests/test_feature_safe_path_guard.py
    310      21.7     5.0      172.8        13     ./tools/complexity_report.py
     20       0.0     0.0        0.0         0     ./examples/__init__.py
    221      15.3     3.3       74.0         3     ./examples/request_constants.py

================================================================================================================
No thresholds exceeded (cyclomatic_complexity > 100 or length > 1000 or nloc > 1000000 or parameter_count > 100)
==========================================================================================
Total nloc   Avg.NLOC  AvgCCN  Avg.token   Fun Cnt  Warning cnt   Fun Rt   nloc Rt
------------------------------------------------------------------------------------------
      3082      12.6     2.8       86.3      200            0      0.00    0.00
